# flood_inject
Unity source generated dependency injection framework

## Contexts

1. GlobalContext -> Always exists
2. SceneContext -> Matching contexts are automatically generated based on scene representation, each SceneContext is identified by sceneName 
3. ScriptableContext -> User defined and registered contexts

## Workflow

1. Creating context assets
```csharp
public partial class HeroContext : ScriptableContext { }
```

2. Bind

```csharp
public static class HeroContextInstaller
{
    public static void Init(HeroInit initData)
    {
        ContextProvider.GetScriptableContext<HeroContext>().Bind(initData);
    }
}

public static class GameCoreSceneInstaller
{
    public static void Init(IGameMode gameMode)
    {
        ContextProvider.GetSceneContext("GameCoreScene").Bind(gameMode);
    }
}
```

3. Resolve

```csharp
[Flood]
public class Hero : MonoBehaviour {

    // Resolve from ScriptableContext
    [Resolve(typeof(HeroContext))] public HeroInit initData;
    
    // Resolve from SceneContext
    [Resolve("GameCoreScene")] public IGameMode gameMode;
    
    // Resolve from GlobalContext
    [Resolve] public PlayerSettings playerSettings;
    
    public void Start() 
    {
        Construct();
    }
}
```

```csharp
// <auto-generated />
using FloodInject.Runtime;
using UnityEngine;

partial class Hero
{
    public virtual void Construct()
    {
        initData = ContextProvider.GetScriptableContext<HeroContext>().Get<HeroInit>();
        gameMode = ContextProvider.GetSceneContext("GameCoreScene").Get<IGameMode>();
        playerSettings = ContextProvider.GetGlobalContext().Get<PlayerSettings>();
        PostConstruct();
    }
    partial void PreConstruct();
    partial void PostConstruct();
}
```