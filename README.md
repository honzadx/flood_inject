# flood_inject
Unity source generated dependency injection framework


## Workflow

1. Creating context objects

```
public partial class SceneContext : BaseContext { }
```

```
// <auto-generated />
public partial class SceneContext 
{
    public static System.Type Type => typeof(SceneContext);
    public override System.Type ContextType => SceneContext.Type;

    protected void OnEnable()
    {
        ContextProvider.Register(this);
    }
    
    protected void OnDestroy()
    {
        ContextProvider.Unregister(this);
    }
}
```

2. Bind, Rebind, Unbind, Get, Reset functionality

```
var data = new Data();
ContextProvider.GetContext<SceneContext>().Bind(data);
```

3. Auto injection from ContextProvider

```
[ContextListener]
public partial class DataWrapper 
{
    [Inject(typeof(SceneContext))] Data data;
}

[ContextListener(true)]
public partial class KeyedDataWrapper : DataWrapper 
{
    [Inject(typeof(SceneContext))] EncryptionKey key;
}
```

```
// <auto-generated />
public partial class DataWrapper
{
    public virtual void Inject()
    {
        data = ContextProvider.GetContext(typeof(SceneContext)).Get<Data>();
    }
}

// <auto-generated />
public partial class KeyedDataWrapper
{
    public override void Inject()
    {
        base.Inject();
        data = ContextProvider.GetContext(typeof(SceneContext)).Get<Data>();
    }
}
```

## TODO:
- [x] Base context definition
    - [x] Bind
    - [x] Rebind
    - [x] Unbind
    - [x] Get
    - [x] Reset
- [x] Context generation
    - [x] Automatic registration
    - [x] Compile time type getter
- [ ] Auto Injection
    - [x] Get context type
    - [x] Build field inject metadata
    - [x] Construct inject method
    - [ ] Trigger injection automatically
- [x] Handle inherited injections
- [ ] Too verbose
- [ ] Investigate verbosity
- [ ] Validate single context per type
- [ ] Handle playmode
- [ ] Unit testing
