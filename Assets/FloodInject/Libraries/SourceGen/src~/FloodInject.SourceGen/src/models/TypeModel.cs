using System.Collections.Immutable;

internal record TypeModel
{
    internal ImmutableArray<string> Usings { get; }
    public string Namespace { get; }
    public ImmutableArray<string> Keywords { get; }
    public string Kind { get; }
    public string Name { get; }
    public BaseTypeElementModel[] Elements { get; }

    public TypeModel(
        string[] usings,
        string @namespace, 
        string[] keywords, 
        string kind,
        string name, 
        BaseTypeElementModel[] elements)
    {
        Usings = ImmutableArray.Create(usings);
        Namespace = @namespace;
        Keywords = ImmutableArray.Create(keywords);
        Kind = kind;
        Name = name;
        Elements = elements;
    }

    public void Build(CodeWriter codeWriter)
    {
        codeWriter.WriteLine("// <auto-generated />");
        foreach (var @using in Usings)
        {
            codeWriter.WriteLine($"using {@using};");
        }
        if (Usings.Length > 0)
        {
            codeWriter.WriteLine();
        }
        codeWriter.StartNamespace(Namespace);
        foreach (var keyword in Keywords)
        {
            codeWriter.Write($"{keyword} ");
        }
        using (codeWriter.CreateScope($"{Kind} {Name}"))
        {
            foreach (var element in Elements)
            {
                element.Build(codeWriter);
            }
        }
        codeWriter.EndNamespace(Namespace);
    }
}